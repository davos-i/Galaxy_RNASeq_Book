<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Workflow - Step 2 | Galaxy Workflow for RNAseq</title>
  <meta name="description" content="<p>This is an instruction manual for using galaxy workflows to analyse RNAseq
fastq files on usegalaxy.org.au (or other similar usegalaxy websites). The aim
of this workflow is to produce a gene x sample count table/matrix from fastq
files.</p>" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Workflow - Step 2 | Galaxy Workflow for RNAseq" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="<p>This is an instruction manual for using galaxy workflows to analyse RNAseq
fastq files on usegalaxy.org.au (or other similar usegalaxy websites). The aim
of this workflow is to produce a gene x sample count table/matrix from fastq
files.</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Workflow - Step 2 | Galaxy Workflow for RNAseq" />
  
  <meta name="twitter:description" content="<p>This is an instruction manual for using galaxy workflows to analyse RNAseq
fastq files on usegalaxy.org.au (or other similar usegalaxy websites). The aim
of this workflow is to produce a gene x sample count table/matrix from fastq
files.</p>" />
  

<meta name="author" content="David Innes" />


<meta name="date" content="2022-01-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="step1.html"/>
<link rel="next" href="multiple-lane-files.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Galaxy workflow for RNAseq</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#workflow-step-1"><i class="fa fa-check"></i>Workflow Step 1</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#workflow-step-2"><i class="fa fa-check"></i>Workflow Step 2</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#user-profile"><i class="fa fa-check"></i>User profile</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="upload-and-prepare-data.html"><a href="upload-and-prepare-data.html"><i class="fa fa-check"></i><b>2</b> Upload and Prepare Data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="upload-and-prepare-data.html"><a href="upload-and-prepare-data.html#import-fastq-files"><i class="fa fa-check"></i><b>2.1</b> Import fastq files</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="upload-and-prepare-data.html"><a href="upload-and-prepare-data.html#upload"><i class="fa fa-check"></i><b>2.1.1</b> Upload</a></li>
<li class="chapter" data-level="2.1.2" data-path="upload-and-prepare-data.html"><a href="upload-and-prepare-data.html#add-files-to-a-collection"><i class="fa fa-check"></i><b>2.1.2</b> Add files to a ‘collection’</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="upload-and-prepare-data.html"><a href="upload-and-prepare-data.html#rename-files"><i class="fa fa-check"></i><b>2.2</b> Rename Files</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="upload-and-prepare-data.html"><a href="upload-and-prepare-data.html#rename-note"><i class="fa fa-check"></i><b>2.2.1</b> A note on multiple lanes</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="upload-and-prepare-data.html"><a href="upload-and-prepare-data.html#import-ensembl-files"><i class="fa fa-check"></i><b>2.3</b> Import ENSEMBL files</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="upload-and-prepare-data.html"><a href="upload-and-prepare-data.html#uncompress-.gtf-file"><i class="fa fa-check"></i><b>2.3.1</b> Uncompress .gtf file</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="step1.html"><a href="step1.html"><i class="fa fa-check"></i><b>3</b> Workflow - Step 1</a>
<ul>
<li class="chapter" data-level="3.1" data-path="step1.html"><a href="step1.html#workflow-instructions"><i class="fa fa-check"></i><b>3.1</b> Find workflow</a></li>
<li class="chapter" data-level="3.2" data-path="step1.html"><a href="step1.html#run-workflow"><i class="fa fa-check"></i><b>3.2</b> Run workflow</a></li>
<li class="chapter" data-level="3.3" data-path="step1.html"><a href="step1.html#view-results"><i class="fa fa-check"></i><b>3.3</b> View results</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="workflow---step-2.html"><a href="workflow---step-2.html"><i class="fa fa-check"></i><b>4</b> Workflow - Step 2</a>
<ul>
<li class="chapter" data-level="4.1" data-path="workflow---step-2.html"><a href="workflow---step-2.html#import-workflow"><i class="fa fa-check"></i><b>4.1</b> Import workflow</a></li>
<li class="chapter" data-level="4.2" data-path="workflow---step-2.html"><a href="workflow---step-2.html#run-workflow-1"><i class="fa fa-check"></i><b>4.2</b> Run Workflow</a></li>
<li class="chapter" data-level="4.3" data-path="workflow---step-2.html"><a href="workflow---step-2.html#save-data"><i class="fa fa-check"></i><b>4.3</b> Save data</a></li>
<li class="chapter" data-level="4.4" data-path="workflow---step-2.html"><a href="workflow---step-2.html#inspect-report"><i class="fa fa-check"></i><b>4.4</b> Inspect Report</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="multiple-lane-files.html"><a href="multiple-lane-files.html"><i class="fa fa-check"></i><b>5</b> More notes on mutliple lane files</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Galaxy Workflow for RNAseq</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="workflow---step-2" class="section level1" number="4">
<h1><span class="header-section-number">Chapter 4</span> Workflow - Step 2</h1>
<p>Step 2 completes multiple steps and reports output to one MultiQC report at the end, with various important outputs to the History.
The most useful output from this workflow for Differential Expression (DE) analysis is the table of counts with rows as gene names and columns as sample names.</p>
<p>The details of the pipeline are visible by following the workflow URL. In short, it uses trimmomatic, RNA STAR Aligner and featureCounts.</p>
<div id="import-workflow" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Import workflow</h2>
<p>Follow instructions in Section <a href="step1.html#workflow-instructions">3.1</a> to add the following workflow:</p>
<p><a href="https://usegalaxy.org.au/u/dave-innes/w/rna-seq-step-2" class="uri">https://usegalaxy.org.au/u/dave-innes/w/rna-seq-step-2</a></p>
</div>
<div id="run-workflow-1" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Run Workflow</h2>
<p>There are 4 required inputs to this workflow. Set it up as follows:</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:run-workflow-step2"></span>
<img src="images/image_step2.png" alt="Setup Step 2 then press Run Workflow" width="100%" />
<p class="caption">
Figure 4.1: Setup Step 2 then press Run Workflow
</p>
</div>
<p><strong>This workflow will take a very long time to run. It runs on the Galaxy server and you can log in from any computer to see it’s status. You’re computer does not need to stay on. An email will also be sent to you once the last step is completed.</strong></p>
</div>
<div id="save-data" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Save data</h2>
<p>Each analysis will require different outputs, but a simple DE analysis will normally only require the featureCounts output that is normally labelled as <code>featureCounts_matrix.tabular</code>. Download this file. It can be previewed in Microsoft Excel by dragging and dropping into an active Excel window, however it is sometimes a large file and best handled in R or other similar software. Also be careful not to save changes if viewing in Excel as some gene names will be converted to date formats in excel and may introduce errors e.g. <code>MARCH1</code> gene.</p>
<p>It is also recommended to save the MultiQC webpage and stats output. This is particularly useful for describing methods when writing up.</p>
<p>You may also want to view the specific alignments and therefore you will need the .bam files. See <a href="https://software.broadinstitute.org/software/igv/BAM" class="uri">https://software.broadinstitute.org/software/igv/BAM</a> for more information.</p>
</div>
<div id="inspect-report" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Inspect Report</h2>
<p>It is important to view the MultiQC webpage and check that all output meets your quality requirements.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="step1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="multiple-lane-files.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/davos-i/Galaxy_RNAseq_Book/edit/main/04_step2.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
